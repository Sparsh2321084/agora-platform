"use strict";(self.webpackChunkagora_platform=self.webpackChunkagora_platform||[]).push([[62],{1062:(i,a,t)=>{t.r(a),t.d(a,{default:()=>d});var e=t(2555),s=t(5043),n=t(9001),c=t(5897),o=t(3488),l=t(579);const r=(0,s.memo)(()=>{const i=(0,n.Zp)(),[a]=(0,s.useState)(()=>JSON.parse(localStorage.getItem("agoraUser")||"null")),[t,r]=(0,s.useState)([]),[d,m]=(0,s.useState)("all"),[f,h]=(0,s.useState)(!0),[u,p]=(0,s.useState)(null);(0,s.useEffect)(()=>{if(!a)return void i("/login");(async()=>{h(!0),p(null);try{const i=await fetch("".concat(o.A.API_URL,"/notifications/").concat(a.userId,"?limit=50"));if(!i.ok)throw new Error("Failed to fetch notifications");const t=await i.json();r(t.notifications||[])}catch(i){console.error("Notification fetch error:",i),p("Failed to load notifications. Please try again."),r([])}finally{h(!1)}})()},[a,i]);const x=t.filter(i=>"all"===d||i.type===d);if(!a)return null;const N=i=>{switch(i){case"reply":return"\ud83d\udcac";case"mention":return"\ud83d\udc64";case"discussion":return"\ud83c\udfdb\ufe0f";default:return"\ud83d\udce2"}};return(0,l.jsx)(c.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"notifications-page",children:(0,l.jsxs)("div",{className:"notifications-container container-golden",children:[(0,l.jsxs)("div",{className:"notifications-header",children:[(0,l.jsxs)("h1",{className:"notifications-title text-epigraphic",children:["\ud83d\udd14 Notifications",(0,l.jsx)("span",{className:"title-greek",children:"\u0395\u03b9\u03b4\u03bf\u03c0\u03bf\u03b9\u03ae\u03c3\u03b5\u03b9\u03c2"})]}),t.some(i=>!i.is_read)&&(0,l.jsx)("button",{className:"mark-read-btn",onClick:async()=>{if(a)try{await fetch("".concat(o.A.API_URL,"/notifications/").concat(a.userId,"/read-all"),{method:"PUT"}),r(i=>i.map(i=>(0,e.A)((0,e.A)({},i),{},{is_read:!0})))}catch(i){console.error("Error marking all as read:",i)}},children:"Mark all as read"})]}),(0,l.jsxs)("div",{className:"notifications-filters",children:[(0,l.jsx)("button",{className:"filter-btn ".concat("all"===d?"active":""),onClick:()=>m("all"),children:"All"}),(0,l.jsx)("button",{className:"filter-btn ".concat("reply"===d?"active":""),onClick:()=>m("reply"),children:"\ud83d\udcac Replies"}),(0,l.jsx)("button",{className:"filter-btn ".concat("mention"===d?"active":""),onClick:()=>m("mention"),children:"\ud83d\udc64 Mentions"}),(0,l.jsx)("button",{className:"filter-btn ".concat("discussion"===d?"active":""),onClick:()=>m("discussion"),children:"\ud83c\udfdb\ufe0f Discussions"})]}),(0,l.jsx)("div",{className:"notifications-list",children:f?(0,l.jsx)("div",{className:"loading-state",children:"Loading notifications..."}):u?(0,l.jsxs)("div",{className:"error-state",children:[(0,l.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,l.jsx)("p",{children:u})]}):0===x.length?(0,l.jsxs)("div",{className:"empty-state",children:[(0,l.jsx)("span",{className:"empty-icon",children:"\ud83d\udced"}),(0,l.jsx)("p",{children:"No notifications yet"}),(0,l.jsx)("button",{className:"cta-btn",onClick:()=>i("/dashboard"),children:"Start Exploring Discussions"})]}):x.map(a=>(0,l.jsxs)(c.P.div,{className:"notification-item ".concat(a.is_read?"":"unread"),onClick:()=>{(async i=>{try{await fetch("".concat(o.A.API_URL,"/notifications/").concat(i,"/read"),{method:"PUT"}),r(a=>a.map(a=>a.id===i?(0,e.A)((0,e.A)({},a),{},{is_read:!0}):a))}catch(a){console.error("Error marking notification as read:",a)}})(a.id),a.link&&i(a.link)},whileHover:{x:5},transition:{duration:.2},children:[(0,l.jsx)("div",{className:"notification-icon",children:N(a.type)}),(0,l.jsxs)("div",{className:"notification-content",children:[(0,l.jsx)("p",{className:"notification-title",children:(0,l.jsx)("strong",{children:a.title})}),(0,l.jsx)("p",{className:"notification-message",children:a.message}),(0,l.jsx)("span",{className:"notification-time",children:new Date(a.created_at).toLocaleString()})]}),!a.is_read&&(0,l.jsx)("span",{className:"unread-dot"})]},a.id))})]})})});r.displayName="Notifications";const d=r}}]);
//# sourceMappingURL=62.7f84d3fe.chunk.js.map